// swift-tools-version: 6.0
// Generated by swift-plugin-generator 0.1.0

import PackageDescription

let package = Package(
    name: "swift-plugin-subtree",
    platforms: [.macOS(.v13)],
    products: [
        .executable(name: "subtree", targets: ["SubtreeExecutable"]),
        .plugin(name: "SubtreePlugin", targets: ["SubtreePlugin"])
    ],
    dependencies: [
        .package(url: "https://github.com/21-DOT-DEV/swift-artifact-parser", exact: "0.0.1")
    ],
    targets: [
        // Executable target - wraps binary using ArtifactParser
        .executableTarget(
            name: "SubtreeExecutable",
            dependencies: [
                .product(name: "ArtifactParser", package: "swift-artifact-parser")
            ]
        ),
        
        // Plugin target - command plugin
        .plugin(
            name: "SubtreePlugin",
            capability: .command(
                intent: .custom(verb: "subtree", description: ""),
                permissions: [.writeToPackageDirectory(reason: "subtree may write output files")]
            ),
            dependencies: ["subtree"]
        ),
        
        // Binary target - references artifact bundle

        .binaryTarget(
            name: "subtree",
            url: "https://github.com/21-DOT-DEV/subtree/releases/download/0.0.4/subtree.artifactbundle.zip",
            checksum: "7a40b0600f4edcc92a21800a76fab2acb74f0b7c9fad80f91335e8902b503f76"
        ),


    ]
)
